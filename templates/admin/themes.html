{% extends "admin/layout.html" %}

{% block content %}
<div class="content-header">
    <h1>
        <span class="icon">
            <i class="fas fa-palette"></i>
        </span>
        Theme Management
    </h1>
    <div class="content-header-actions">
        <button class="button is-primary" onclick="refreshThemes()">
            <span class="icon">
                <i class="fas fa-sync-alt"></i>
            </span>
            <span>Refresh Themes</span>
        </button>
        <button class="button is-warning" onclick="validateAllThemes()">
            <span class="icon">
                <i class="fas fa-check-double"></i>
            </span>
            <span>Validate All</span>
        </button>
        <button class="button is-success" onclick="showUploadModal()">
            <span class="icon">
                <i class="fas fa-upload"></i>
            </span>
            <span>Upload Theme</span>
        </button>
    </div>
</div>

<div class="columns">
    <div class="column is-8">
        <div class="form-section">
            <h3>
                <span class="icon">
                    <i class="fas fa-th-large"></i>
                </span>
                Available Themes
            </h3>

            <div id="themes-container">
                <div class="has-text-centered" style="padding: 2rem;">
                    <span class="icon is-large">
                        <i class="fas fa-spinner fa-pulse fa-2x"></i>
                    </span>
                    <p>Loading themes...</p>
                </div>
            </div>
        </div>
    </div>

    <div class="column is-4">
        <div class="form-section">
            <h3>
                <span class="icon">
                    <i class="fas fa-info-circle"></i>
                </span>
                Current Theme
            </h3>

            <div id="current-theme-info">
                <div class="has-text-centered" style="padding: 2rem;">
                    <span class="icon is-large">
                        <i class="fas fa-spinner fa-pulse fa-2x"></i>
                    </span>
                    <p>Loading current theme...</p>
                </div>
            </div>
        </div>

        <div class="form-section">
            <h3>
                <span class="icon">
                    <i class="fas fa-question-circle"></i>
                </span>
                Theme Support
            </h3>

            <div class="content">
                <div class="notification is-info is-light">
                    <h4>Ghost Theme Compatibility</h4>
                    <p>Stack Blog supports Ghost themes out of the box! Simply place any Ghost theme in the <code>themes/</code> directory.</p>
                </div>

                <div class="box">
                    <h5>Supported Features:</h5>
                    <ul>
                        <li>✅ Handlebars templates (.hbs)</li>
                        <li>✅ Ghost helpers (foreach, asset, navigation)</li>
                        <li>✅ Theme assets (CSS, JS, fonts)</li>
                        <li>✅ Partials and layouts</li>
                        <li>✅ Context variables (posts, pagination)</li>
                        <li>✅ Meta tags and SEO</li>
                    </ul>
                </div>

                <div class="notification is-warning is-light">
                    <p><strong>Note:</strong> Some advanced Ghost features like routes.yaml may have limited support in this version.</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Theme Details Modal -->
<div class="modal" id="theme-details-modal">
    <div class="modal-background" onclick="closeThemeModal()"></div>
    <div class="modal-card">
        <header class="modal-card-head">
            <p class="modal-card-title" id="theme-modal-title">Theme Details</p>
            <button class="delete" aria-label="close" onclick="closeThemeModal()"></button>
        </header>
        <section class="modal-card-body" id="theme-modal-body">
            <!-- Content will be populated by JavaScript -->
        </section>
        <footer class="modal-card-foot">
            <button class="button is-primary" id="activate-theme-btn" onclick="activateTheme()">Activate Theme</button>
            <button class="button" onclick="closeThemeModal()">Cancel</button>
        </footer>
    </div>
</div>

<!-- Theme Validation Modal -->
<div class="modal" id="theme-validation-modal">
    <div class="modal-background" onclick="closeValidationModal()"></div>
    <div class="modal-card" style="width: 90%; max-width: 800px;">
        <header class="modal-card-head">
            <p class="modal-card-title" id="validation-modal-title">Theme Validation Results</p>
            <button class="delete" aria-label="close" onclick="closeValidationModal()"></button>
        </header>
        <section class="modal-card-body" id="validation-modal-body">
            <!-- Content will be populated by JavaScript -->
        </section>
        <footer class="modal-card-foot">
            <button class="button" onclick="closeValidationModal()">Close</button>
        </footer>
    </div>
</div>

<!-- Theme Upload Modal -->
<div class="modal" id="theme-upload-modal">
    <div class="modal-background" onclick="closeUploadModal()"></div>
    <div class="modal-card">
        <header class="modal-card-head">
            <p class="modal-card-title">Upload Theme</p>
            <button class="delete" aria-label="close" onclick="closeUploadModal()"></button>
        </header>
        <section class="modal-card-body">
            <form id="theme-upload-form" enctype="multipart/form-data">
                <div class="field">
                    <label class="label">Theme ZIP File</label>
                    <div class="control">
                        <div class="file has-name is-fullwidth">
                            <label class="file-label">
                                <input class="file-input" type="file" name="themeFile" accept=".zip" required>
                                <span class="file-cta">
                                    <span class="file-icon">
                                        <i class="fas fa-upload"></i>
                                    </span>
                                    <span class="file-label">Choose file…</span>
                                </span>
                                <span class="file-name">No file selected</span>
                            </label>
                        </div>
                    </div>
                    <p class="help">Upload a ZIP file containing a Ghost theme. Maximum size: 50MB</p>
                </div>
                
                <div class="field">
                    <label class="label">Theme Name (Optional)</label>
                    <div class="control">
                        <input class="input" type="text" name="themeName" placeholder="Leave empty to use original name">
                    </div>
                    <p class="help">Override the theme name. If empty, the name will be extracted from package.json or filename.</p>
                </div>
            </form>
        </section>
        <footer class="modal-card-foot">
            <button class="button is-success" onclick="uploadTheme()">
                <span class="icon">
                    <i class="fas fa-upload"></i>
                </span>
                <span>Upload</span>
            </button>
            <button class="button" onclick="closeUploadModal()">Cancel</button>
        </footer>
    </div>
</div>

<script>
let currentThemeData = null;
let selectedTheme = null;

// Load themes on page load
document.addEventListener('DOMContentLoaded', function() {
    loadThemes();
    loadCurrentTheme();
});

async function loadThemes() {
    try {
        const response = await fetch('/admin/api/themes');
        const themes = await response.json();
        
        const container = document.getElementById('themes-container');
        
        if (themes.length === 0) {
            container.innerHTML = `
                <div class="notification is-warning">
                    <h4>No themes found</h4>
                    <p>Place Ghost themes in the <code>themes/</code> directory to get started.</p>
                </div>
            `;
            return;
        }
        
        const themesHTML = themes.map(theme => `
            <div class="box theme-card" data-theme="${theme.name}">
                <div class="media">
                    <div class="media-left">
                        <figure class="image is-64x64">
                            <div class="box has-text-centered theme-icon ${theme.engine === 'ghost' ? 'is-primary' : theme.engine === 'handlebars' ? 'is-info' : 'is-light'}" style="height: 64px; display: flex; align-items: center; justify-content: center;">
                                <span class="icon is-large">
                                    <i class="fas ${getThemeIcon(theme.engine)} fa-2x"></i>
                                </span>
                            </div>
                        </figure>
                    </div>
                    <div class="media-content">
                        <div class="content">
                            <h4>${theme.name}</h4>
                            <p class="subtitle is-6">
                                <span class="tag ${getEngineClass(theme.engine)}">${theme.engine}</span>
                                ${theme.version ? `<span class="tag is-light">v${theme.version}</span>` : ''}
                                ${currentThemeData && currentThemeData.name === theme.name ? '<span class="tag is-success">Active</span>' : ''}
                            </p>
                            ${theme.description ? `<p>${theme.description}</p>` : ''}
                        </div>
                    </div>
                    <div class="media-right">
                        <div class="buttons">
                            <button class="button is-small is-info" onclick="showThemeDetails('${theme.name}')">
                                <span class="icon">
                                    <i class="fas fa-info"></i>
                                </span>
                                <span>Details</span>
                            </button>
                            <div class="dropdown is-hoverable">
                                <div class="dropdown-trigger">
                                    <button class="button is-small" aria-haspopup="true" aria-controls="dropdown-menu">
                                        <span class="icon">
                                            <i class="fas fa-ellipsis-v"></i>
                                        </span>
                                    </button>
                                </div>
                                <div class="dropdown-menu" role="menu">
                                    <div class="dropdown-content">
                                        <a class="dropdown-item" onclick="validateTheme('${theme.name}')">
                                            <span class="icon">
                                                <i class="fas fa-check-circle"></i>
                                            </span>
                                            Validate
                                        </a>
                                        <a class="dropdown-item" onclick="exportTheme('${theme.name}')">
                                            <span class="icon">
                                                <i class="fas fa-download"></i>
                                            </span>
                                            Export
                                        </a>
                                        ${!['default', 'casper-basic'].includes(theme.name) && currentThemeData?.name !== theme.name ? `
                                            <hr class="dropdown-divider">
                                            <a class="dropdown-item has-text-danger" onclick="deleteTheme('${theme.name}')">
                                                <span class="icon">
                                                    <i class="fas fa-trash"></i>
                                                </span>
                                                Delete
                                            </a>
                                        ` : ''}
                                    </div>
                                </div>
                            </div>
                            ${currentThemeData && currentThemeData.name === theme.name ? '' : `
                                <button class="button is-small is-primary" onclick="activateThemeDirectly('${theme.name}', '${theme.engine === 'ghost' ? 'handlebars' : theme.engine}')">
                                    <span class="icon">
                                        <i class="fas fa-check"></i>
                                    </span>
                                    <span>Activate</span>
                                </button>
                            `}
                        </div>
                    </div>
                </div>
            </div>
        `).join('');
        
        container.innerHTML = themesHTML;
        
    } catch (error) {
        console.error('Error loading themes:', error);
        document.getElementById('themes-container').innerHTML = `
            <div class="notification is-danger">
                <h4>Error loading themes</h4>
                <p>Unable to load theme list. Please try again.</p>
            </div>
        `;
    }
}

async function loadCurrentTheme() {
    try {
        const response = await fetch('/admin/api/themes/current');
        currentThemeData = await response.json();
        
        const container = document.getElementById('current-theme-info');
        
        if (currentThemeData) {
            container.innerHTML = `
                <div class="box">
                    <div class="media">
                        <div class="media-left">
                            <figure class="image is-48x48">
                                <div class="box has-text-centered ${getEngineClass(currentThemeData.engine)}" style="height: 48px; display: flex; align-items: center; justify-content: center;">
                                    <span class="icon">
                                        <i class="fas ${getThemeIcon(currentThemeData.engine)}"></i>
                                    </span>
                                </div>
                            </figure>
                        </div>
                        <div class="media-content">
                            <h5>${currentThemeData.name}</h5>
                            <p class="subtitle is-6">
                                <span class="tag ${getEngineClass(currentThemeData.engine)}">${currentThemeData.engine}</span>
                                <span class="tag is-success">Active</span>
                            </p>
                        </div>
                    </div>
                    ${currentThemeData.description ? `<p>${currentThemeData.description}</p>` : ''}
                </div>
            `;
        } else {
            container.innerHTML = `
                <div class="notification is-warning">
                    <p>No active theme detected</p>
                </div>
            `;
        }
        
    } catch (error) {
        console.error('Error loading current theme:', error);
    }
}

function getThemeIcon(engine) {
    switch (engine) {
        case 'ghost':
        case 'handlebars':
            return 'fa-ghost';
        case 'nunjucks':
            return 'fa-code';
        default:
            return 'fa-palette';
    }
}

function getEngineClass(engine) {
    switch (engine) {
        case 'ghost':
            return 'is-primary';
        case 'handlebars':
            return 'is-info';
        case 'nunjucks':
            return 'is-warning';
        default:
            return 'is-light';
    }
}

async function showThemeDetails(themeName) {
    try {
        const response = await fetch(`/admin/api/themes/${themeName}`);
        const theme = await response.json();
        
        selectedTheme = theme;
        
        document.getElementById('theme-modal-title').textContent = `${theme.name} Details`;
        
        const modalBody = document.getElementById('theme-modal-body');
        modalBody.innerHTML = `
            <div class="content">
                <h5>Theme Information</h5>
                <table class="table is-fullwidth">
                    <tbody>
                        <tr>
                            <td><strong>Name</strong></td>
                            <td>${theme.name}</td>
                        </tr>
                        <tr>
                            <td><strong>Engine</strong></td>
                            <td>
                                <span class="tag ${getEngineClass(theme.engine)}">${theme.engine}</span>
                            </td>
                        </tr>
                        ${theme.version ? `
                            <tr>
                                <td><strong>Version</strong></td>
                                <td>${theme.version}</td>
                            </tr>
                        ` : ''}
                        ${theme.description ? `
                            <tr>
                                <td><strong>Description</strong></td>
                                <td>${theme.description}</td>
                            </tr>
                        ` : ''}
                    </tbody>
                </table>
                
                ${theme.files ? `
                    <h5>Theme Files</h5>
                    <div class="box">
                        ${theme.files.map(file => `<span class="tag is-light" style="margin: 2px;">${file}</span>`).join('')}
                    </div>
                ` : ''}
            </div>
        `;
        
        const activateBtn = document.getElementById('activate-theme-btn');
        if (currentThemeData && currentThemeData.name === theme.name) {
            activateBtn.style.display = 'none';
        } else {
            activateBtn.style.display = 'inline-block';
        }
        
        document.getElementById('theme-details-modal').classList.add('is-active');
        
    } catch (error) {
        console.error('Error loading theme details:', error);
        showNotification('Error loading theme details', 'is-danger');
    }
}

function closeThemeModal() {
    document.getElementById('theme-details-modal').classList.remove('is-active');
    selectedTheme = null;
}

async function activateTheme() {
    if (!selectedTheme) return;
    
    await activateThemeDirectly(selectedTheme.name, selectedTheme.engine === 'ghost' ? 'handlebars' : selectedTheme.engine);
    closeThemeModal();
}

async function activateThemeDirectly(themeName, engine) {
    try {
        const response = await fetch('/admin/api/themes/activate', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                theme: themeName,
                engine: engine
            })
        });
        
        const result = await response.json();
        
        if (response.ok) {
            showNotification(`Theme "${themeName}" activated successfully!`, 'is-success');
            loadCurrentTheme();
            loadThemes(); // Reload to update active status
        } else {
            showNotification(result.error || 'Failed to activate theme', 'is-danger');
        }
        
    } catch (error) {
        console.error('Error activating theme:', error);
        showNotification('Error activating theme', 'is-danger');
    }
}

async function refreshThemes() {
    showNotification('Refreshing themes...', 'is-info');
    await loadThemes();
    await loadCurrentTheme();
    showNotification('Themes refreshed!', 'is-success');
}

async function validateTheme(themeName) {
    try {
        showNotification(`Validating theme "${themeName}"...`, 'is-info');
        
        const response = await fetch(`/admin/api/themes/${themeName}/validate`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            }
        });
        
        const result = await response.json();
        
        if (response.ok) {
            showValidationResults(result.validation, themeName);
        } else {
            showNotification(result.error || 'Failed to validate theme', 'is-danger');
        }
        
    } catch (error) {
        console.error('Error validating theme:', error);
        showNotification('Error validating theme', 'is-danger');
    }
}

async function validateAllThemes() {
    try {
        showNotification('Validating all themes...', 'is-info');
        
        const response = await fetch('/admin/api/themes/validate-all', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            }
        });
        
        const result = await response.json();
        
        if (response.ok) {
            showBatchValidationResults(result.validations);
            showNotification(`Validated ${result.count} themes!`, 'is-success');
        } else {
            showNotification(result.error || 'Failed to validate themes', 'is-danger');
        }
        
    } catch (error) {
        console.error('Error validating themes:', error);
        showNotification('Error validating themes', 'is-danger');
    }
}

function showValidationResults(validation, themeName) {
    document.getElementById('validation-modal-title').textContent = `${themeName} Validation Results`;
    
    const modalBody = document.getElementById('validation-modal-body');
    modalBody.innerHTML = `
        <div class="content">
            <div class="box">
                <h4>Overall Status</h4>
                <div class="level">
                    <div class="level-left">
                        <div class="level-item">
                            <span class="tag ${getCompatibilityClass(validation.summary.compatibility)} is-large">
                                ${validation.summary.compatibility.toUpperCase()}
                            </span>
                        </div>
                    </div>
                    <div class="level-right">
                        <div class="level-item">
                            <span class="tag ${validation.valid ? 'is-success' : 'is-danger'}">
                                ${validation.valid ? 'VALID' : 'INVALID'}
                            </span>
                        </div>
                    </div>
                </div>
                
                <div class="columns">
                    <div class="column">
                        <div class="has-text-centered">
                            <p class="heading">Errors</p>
                            <p class="title is-4 ${validation.summary.errorCount > 0 ? 'has-text-danger' : 'has-text-success'}">
                                ${validation.summary.errorCount}
                            </p>
                        </div>
                    </div>
                    <div class="column">
                        <div class="has-text-centered">
                            <p class="heading">Warnings</p>
                            <p class="title is-4 ${validation.summary.warningCount > 0 ? 'has-text-warning' : 'has-text-success'}">
                                ${validation.summary.warningCount}
                            </p>
                        </div>
                    </div>
                    <div class="column">
                        <div class="has-text-centered">
                            <p class="heading">Stack Blog</p>
                            <p class="title is-4 ${getCompatibilityClass(validation.stackBlogCompatibility.overall)}">
                                ${validation.stackBlogCompatibility.overall.toUpperCase()}
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            
            ${validation.errors.length > 0 ? `
                <div class="box">
                    <h5 class="has-text-danger">
                        <span class="icon">
                            <i class="fas fa-exclamation-triangle"></i>
                        </span>
                        Errors (${validation.errors.length})
                    </h5>
                    ${validation.errors.map(error => `
                        <div class="notification is-danger is-light">
                            <strong>${error.code}</strong>: ${error.message}
                            ${error.file ? `<br><small>File: ${error.file}</small>` : ''}
                        </div>
                    `).join('')}
                </div>
            ` : ''}
            
            ${validation.warnings.length > 0 ? `
                <div class="box">
                    <h5 class="has-text-warning">
                        <span class="icon">
                            <i class="fas fa-exclamation-circle"></i>
                        </span>
                        Warnings (${validation.warnings.length})
                    </h5>
                    ${validation.warnings.slice(0, 10).map(warning => `
                        <div class="notification is-warning is-light">
                            <strong>${warning.code}</strong>: ${warning.message}
                            ${warning.file ? `<br><small>File: ${warning.file}</small>` : ''}
                        </div>
                    `).join('')}
                    ${validation.warnings.length > 10 ? `<p class="has-text-grey">... and ${validation.warnings.length - 10} more</p>` : ''}
                </div>
            ` : ''}
            
            <div class="box">
                <h5>Stack Blog Compatibility</h5>
                <div class="content">
                    <ul>
                        <li>Index Template: ${validation.stackBlogCompatibility.hasIndexTemplate ? '✅' : '❌'}</li>
                        <li>Post Template: ${validation.stackBlogCompatibility.hasPostTemplate ? '✅' : '❌'}</li>
                        <li>Assets Directory: ${validation.stackBlogCompatibility.hasAssets ? '✅' : '❌'}</li>
                        <li>Ghost Helpers: ${validation.stackBlogCompatibility.usesGhostHelpers ? '✅' : '❌'}</li>
                        <li>Package.json: ${validation.stackBlogCompatibility.hasPackageJson ? '✅' : '❌'}</li>
                    </ul>
                </div>
            </div>
        </div>
    `;
    
    document.getElementById('theme-validation-modal').classList.add('is-active');
}

function showBatchValidationResults(validations) {
    const summary = Object.entries(validations).map(([themeName, validation]) => {
        const compat = validation.stackBlogCompatibility?.overall || 'unknown';
        return `
            <tr>
                <td>${themeName}</td>
                <td>
                    <span class="tag ${validation.valid ? 'is-success' : 'is-danger'}">
                        ${validation.valid ? 'Valid' : 'Invalid'}
                    </span>
                </td>
                <td>
                    <span class="tag ${getCompatibilityClass(compat)}">
                        ${compat}
                    </span>
                </td>
                <td>${validation.summary?.errorCount || 0}</td>
                <td>${validation.summary?.warningCount || 0}</td>
                <td>
                    <button class="button is-small is-info" onclick="validateTheme('${themeName}')">
                        Details
                    </button>
                </td>
            </tr>
        `;
    }).join('');

    document.getElementById('validation-modal-title').textContent = 'All Themes Validation Summary';
    
    const modalBody = document.getElementById('validation-modal-body');
    modalBody.innerHTML = `
        <div class="content">
            <table class="table is-fullwidth is-striped">
                <thead>
                    <tr>
                        <th>Theme</th>
                        <th>Status</th>
                        <th>Compatibility</th>
                        <th>Errors</th>
                        <th>Warnings</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    ${summary}
                </tbody>
            </table>
        </div>
    `;
    
    document.getElementById('theme-validation-modal').classList.add('is-active');
}

function getCompatibilityClass(level) {
    switch (level) {
        case 'excellent': return 'is-success';
        case 'good': return 'is-info';
        case 'fair': return 'is-warning';
        case 'poor': return 'is-danger';
        case 'incompatible': return 'is-dark';
        default: return 'is-light';
    }
}

function closeValidationModal() {
    document.getElementById('theme-validation-modal').classList.remove('is-active');
}

function showUploadModal() {
    document.getElementById('theme-upload-modal').classList.add('is-active');
    
    // Reset form
    document.getElementById('theme-upload-form').reset();
    document.querySelector('.file-name').textContent = 'No file selected';
}

function closeUploadModal() {
    document.getElementById('theme-upload-modal').classList.remove('is-active');
}

async function uploadTheme() {
    const form = document.getElementById('theme-upload-form');
    const formData = new FormData(form);
    
    const fileInput = form.querySelector('input[type="file"]');
    if (!fileInput.files[0]) {
        showNotification('Please select a theme file', 'is-danger');
        return;
    }
    
    try {
        showNotification('Uploading theme...', 'is-info');
        
        const response = await fetch('/admin/api/themes/upload', {
            method: 'POST',
            body: formData
        });
        
        const result = await response.json();
        
        if (response.ok) {
            showNotification(`Theme "${result.theme}" uploaded successfully!`, 'is-success');
            closeUploadModal();
            await loadThemes();
            
            // Show validation results if available
            if (result.validation) {
                setTimeout(() => {
                    showValidationResults(result.validation, result.theme);
                }, 1000);
            }
        } else {
            showNotification(result.error || 'Failed to upload theme', 'is-danger');
        }
        
    } catch (error) {
        console.error('Error uploading theme:', error);
        showNotification('Error uploading theme', 'is-danger');
    }
}

async function deleteTheme(themeName) {
    if (!confirm(`Are you sure you want to delete the theme "${themeName}"? This action cannot be undone.`)) {
        return;
    }
    
    try {
        showNotification(`Deleting theme "${themeName}"...`, 'is-info');
        
        const response = await fetch(`/admin/api/themes/${themeName}/delete`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            }
        });
        
        const result = await response.json();
        
        if (response.ok) {
            showNotification(`Theme "${themeName}" deleted successfully!`, 'is-success');
            await loadThemes();
        } else {
            showNotification(result.error || 'Failed to delete theme', 'is-danger');
        }
        
    } catch (error) {
        console.error('Error deleting theme:', error);
        showNotification('Error deleting theme', 'is-danger');
    }
}

async function exportTheme(themeName) {
    try {
        showNotification(`Exporting theme "${themeName}"...`, 'is-info');
        
        const response = await fetch(`/admin/api/themes/${themeName}/export`);
        
        if (response.ok) {
            const blob = await response.blob();
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${themeName}.zip`;
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
            document.body.removeChild(a);
            
            showNotification(`Theme "${themeName}" exported successfully!`, 'is-success');
        } else {
            const result = await response.json();
            showNotification(result.error || 'Failed to export theme', 'is-danger');
        }
        
    } catch (error) {
        console.error('Error exporting theme:', error);
        showNotification('Error exporting theme', 'is-danger');
    }
}

function showNotification(message, type = 'is-info') {
    const notification = document.createElement('div');
    notification.className = `notification ${type}`;
    notification.innerHTML = `
        <button class="delete" onclick="this.parentElement.remove()"></button>
        ${message}
    `;
    
    document.body.appendChild(notification);
    notification.style.position = 'fixed';
    notification.style.top = '20px';
    notification.style.right = '20px';
    notification.style.zIndex = '9999';
    notification.style.maxWidth = '300px';
    
    setTimeout(() => {
        if (notification.parentElement) {
            notification.remove();
        }
    }, 5000);
}
// File input handling
document.addEventListener('DOMContentLoaded', function() {
    const fileInput = document.querySelector('#theme-upload-form input[type="file"]');
    const fileName = document.querySelector('#theme-upload-form .file-name');
    
    if (fileInput && fileName) {
        fileInput.addEventListener('change', function() {
            if (this.files[0]) {
                fileName.textContent = this.files[0].name;
            } else {
                fileName.textContent = 'No file selected';
            }
        });
    }
});
</script>

<style>
.theme-card {
    transition: box-shadow 0.3s ease;
}

.theme-card:hover {
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

.theme-icon {
    border-radius: 8px;
}

.content-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
}

.content-header-actions {
    display: flex;
    gap: 1rem;
}
</style>
{% endblock %}